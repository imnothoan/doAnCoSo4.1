# HÆ°á»›ng Dáº«n CÃ¡c TÃ­nh NÄƒng Má»›i - ConnectSphere

## Tá»•ng Quan CÃ¡c Thay Äá»•i

ChÃ o báº¡n! TÃ´i Ä‘Ã£ hoÃ n thÃ nh táº¥t cáº£ cÃ¡c yÃªu cáº§u cá»§a báº¡n. DÆ°á»›i Ä‘Ã¢y lÃ  chi tiáº¿t cÃ¡c váº¥n Ä‘á» Ä‘Ã£ Ä‘Æ°á»£c sá»­a vÃ  tÃ­nh nÄƒng má»›i Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o.

## CÃ¡c Lá»—i ÄÃ£ Sá»­a âœ…

### 1. Lá»—i Hiá»ƒn Thá»‹ Inbox
**Váº¥n Ä‘á»**: Inbox khÃ´ng hiá»ƒn thá»‹ Ä‘Ãºng tÃªn vÃ  avatar cá»§a ngÆ°á»i mÃ  mÃ¬nh Ä‘ang trÃ² chuyá»‡n (nhÆ° Messenger cá»§a Facebook).

**ÄÃ£ sá»­a**: 
- Cáº­p nháº­t API Ä‘á»ƒ láº¥y Ä‘áº§y Ä‘á»§ thÃ´ng tin ngÆ°á»i tham gia cuá»™c trÃ² chuyá»‡n
- Hiá»‡n táº¡i inbox sáº½ hiá»ƒn thá»‹:
  - Avatar cá»§a ngÆ°á»i kia
  - TÃªn cá»§a ngÆ°á»i kia
  - Tin nháº¯n cuá»‘i cÃ¹ng
  - Tráº¡ng thÃ¡i Ä‘Ã£ Ä‘á»c/chÆ°a Ä‘á»c (unread count)

### 2. Lá»—i Tin Nháº¯n Bá»‹ Láº·p
**Váº¥n Ä‘á»**: Khi gá»­i tin nháº¯n (vÃ­ dá»¥: "hello"), nÃ³ hiá»ƒn thá»‹ 2 láº§n. Pháº£i thoÃ¡t ra vÃ o láº¡i má»›i tháº¥y 1 láº§n.

**ÄÃ£ sá»­a**:
- Sá»­a logic WebSocket Ä‘á»ƒ khÃ´ng Ä‘Äƒng kÃ½ event listener nhiá»u láº§n
- ThÃªm kiá»ƒm tra trÃ¹ng láº·p tin nháº¯n dá»±a trÃªn:
  - ID cá»§a tin nháº¯n
  - Ná»™i dung, ngÆ°á»i gá»­i vÃ  thá»i gian
- BÃ¢y giá» má»—i tin nháº¯n chá»‰ hiá»ƒn thá»‹ Ä‘Ãºng 1 láº§n

### 3. Lá»—i Hiá»ƒn Thá»‹ Followers/Following
**Váº¥n Ä‘á»**: á» trang Account, pháº§n Summary khÃ´ng hiá»ƒn thá»‹ Ä‘ang following ai vÃ  cÃ³ bao nhiÃªu follower.

**ÄÃ£ sá»­a**:
- Sá»‘ lÆ°á»£ng followers vÃ  following hiá»‡n cÃ³ thá»ƒ báº¥m vÃ o Ä‘Æ°á»£c
- Khi báº¥m vÃ o sáº½ má»Ÿ trang má»›i hiá»ƒn thá»‹ danh sÃ¡ch ngÆ°á»i theo dÃµi hoáº·c Ä‘ang theo dÃµi
- CÃ³ thá»ƒ báº¥m vÃ o tá»«ng ngÆ°á»i trong danh sÃ¡ch Ä‘á»ƒ xem profile cá»§a há»

## TÃ­nh NÄƒng Má»›i - GÃ³i Pro â­

### 1. Trang Payment & Pro Features

**CÃ¡ch truy cáº­p**: Account â†’ Settings â†’ Payment & Pro Features

**Ná»™i dung trang**:
- Hiá»ƒn thá»‹ tráº¡ng thÃ¡i hiá»‡n táº¡i (Free Member hoáº·c Pro Member)
- Danh sÃ¡ch tÃ­nh nÄƒng Pro:
  - ğŸ“± **Giá»›i háº¡n Follow cao hÆ¡n**: 512 ngÆ°á»i (thay vÃ¬ 16 ngÆ°á»i cá»§a gÃ³i miá»…n phÃ­)
  - âœ¨ **AI viáº¿t bÃ i**: Sá»­ dá»¥ng AI Ä‘á»ƒ viáº¿t post (tÃ­nh nÄƒng sáº½ lÃ m sau)
  - ğŸ¨ **Giao diá»‡n Ä‘á»™c quyá»n**: Theme mÃ u vÃ ng-tráº¯ng cho thÃ nh viÃªn Pro
  - âš¡ **Há»— trá»£ Æ°u tiÃªn**: ÄÆ°á»£c há»— trá»£ nhanh hÆ¡n tá»« team
- GiÃ¡: $9.99/thÃ¡ng (Cháº¿ Ä‘á»™ Test - khÃ´ng tÃ­nh tiá»n tháº­t)
- NÃºt Subscribe/Cancel subscription

### 2. Há»‡ Thá»‘ng Thanh ToÃ¡n (Test Mode)

**LÆ°u Ã½**: ÄÃ¢y lÃ  cháº¿ Ä‘á»™ TEST, khÃ´ng thu tiá»n tháº­t.

**CÃ¡ch Ä‘Äƒng kÃ½ Pro**:
1. VÃ o Account â†’ Payment & Pro Features
2. Báº¥m nÃºt "Subscribe to Pro"
3. XÃ¡c nháº­n trong dialog
4. Há»‡ thá»‘ng sáº½:
   - KÃ­ch hoáº¡t tÃ i khoáº£n Pro
   - Äá»•i theme sang mÃ u vÃ ng
   - Hiá»ƒn thá»‹ badge "PRO" trÃªn profile
   - Má»Ÿ khÃ³a giá»›i háº¡n 512 follows

**CÃ¡ch há»§y Ä‘Äƒng kÃ½**:
1. VÃ o láº¡i Payment & Pro Features
2. Báº¥m "Cancel Subscription"
3. XÃ¡c nháº­n
4. Theme sáº½ trá»Ÿ vá» mÃ u xanh dÆ°Æ¡ng

### 3. Theme MÃ u Sáº¯c

**GÃ³i Miá»…n PhÃ­ (Regular)**:
- MÃ u chÃ­nh: Xanh dÆ°Æ¡ng (#007AFF - mÃ u iOS)
- Ná»n: XÃ¡m nháº¡t (#f5f5f5)
- PhÃ¹ há»£p vá»›i giao diá»‡n chuáº©n

**GÃ³i Pro**:
- MÃ u chÃ­nh: VÃ ng/VÃ ng kim (#FFB300)
- Ná»n: Tráº¯ng áº¥m (#FFFBF0)
- Giao diá»‡n cao cáº¥p hÆ¡n

**Nhá»¯ng gÃ¬ thay Ä‘á»•i khi chuyá»ƒn sang Pro**:
- MÃ u cÃ¡c nÃºt báº¥m
- MÃ u thanh tiáº¿n trÃ¬nh
- MÃ u viá»n vÃ  icon
- MÃ u badge vÃ  tag
- Background mÃ u áº¥m hÆ¡n

### 4. Badge Pro

Khi lÃ  thÃ nh viÃªn Pro, sáº½ hiá»ƒn thá»‹ badge "â­ PRO" bÃªn cáº¡nh tÃªn á»Ÿ:
- Trang Account
- (CÃ³ thá»ƒ thÃªm vÃ o cÃ¡c trang khÃ¡c sau)

## API Endpoints Cáº§n Thiáº¿t

Äá»ƒ cÃ¡c tÃ­nh nÄƒng nÃ y hoáº¡t Ä‘á»™ng, server cáº§n cÃ³ cÃ¡c endpoint sau:

### Followers/Following:
```
GET /users/:username/followers
GET /users/:username/following
```

### Pro Subscription:
```
POST /subscriptions/activate
Body: { username: string }

POST /subscriptions/deactivate
Body: { username: string }

GET /subscriptions/status/:username
Response: { isPro: boolean, expiresAt?: string }
```

### Conversations:
```
GET /messages/conversations?user=:username
Response pháº£i cÃ³: participants array vá»›i Ä‘áº§y Ä‘á»§ thÃ´ng tin user
```

## HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng

### Test TÃ­nh NÄƒng Pro:

1. **ÄÄƒng nháº­p** vÃ o app
2. VÃ o **Account** tab
3. Cuá»™n xuá»‘ng pháº§n **Settings**
4. Báº¥m vÃ o **Payment & Pro Features**
5. Xem danh sÃ¡ch tÃ­nh nÄƒng Pro
6. Báº¥m **Subscribe to Pro** Ä‘á»ƒ kÃ­ch hoáº¡t
7. Quan sÃ¡t:
   - Badge "PRO" xuáº¥t hiá»‡n bÃªn cáº¡nh tÃªn
   - MÃ u sáº¯c app chuyá»ƒn tá»« xanh sang vÃ ng
   - CÃ³ thá»ƒ follow tá»›i 512 ngÆ°á»i
8. Test há»§y Ä‘Äƒng kÃ½ báº±ng nÃºt **Cancel Subscription**

### Test Inbox Fixed:

1. VÃ o **Inbox** tab
2. Kiá»ƒm tra:
   - Má»—i conversation hiá»ƒn thá»‹ Ä‘Ãºng tÃªn ngÆ°á»i kia
   - Hiá»ƒn thá»‹ avatar cá»§a ngÆ°á»i kia
   - Sá»‘ tin nháº¯n chÆ°a Ä‘á»c (unread count) hiá»‡n ra náº¿u cÃ³
3. Báº¥m vÃ o má»™t conversation
4. Gá»­i tin nháº¯n
5. Kiá»ƒm tra tin nháº¯n chá»‰ hiá»‡n 1 láº§n (khÃ´ng bá»‹ láº·p)

### Test Followers/Following:

1. VÃ o **Account** tab
2. Pháº§n **Summary**, báº¥m vÃ o sá»‘ **Followers**
3. Xem danh sÃ¡ch ngÆ°á»i theo dÃµi báº¡n
4. Quay láº¡i, báº¥m vÃ o sá»‘ **Following**
5. Xem danh sÃ¡ch ngÆ°á»i báº¡n Ä‘ang theo dÃµi
6. Báº¥m vÃ o má»™t ngÆ°á»i trong danh sÃ¡ch Ä‘á»ƒ xem profile

## Giá»›i Háº¡n Theo GÃ³i

### GÃ³i Miá»…n PhÃ­:
- Follow tá»‘i Ä‘a: **16 ngÆ°á»i**
- Theme: Xanh dÆ°Æ¡ng - Tráº¯ng
- KhÃ´ng dÃ¹ng Ä‘Æ°á»£c AI viáº¿t bÃ i

### GÃ³i Pro ($9.99/thÃ¡ng - Test Mode):
- Follow tá»‘i Ä‘a: **512 ngÆ°á»i**
- Theme: VÃ ng - Tráº¯ng áº¥m
- Badge "PRO" trÃªn profile
- Sáº½ cÃ³ AI viáº¿t bÃ i (tÆ°Æ¡ng lai)
- Há»— trá»£ Æ°u tiÃªn

## CÃ¡c File ÄÃ£ Táº¡o/Sá»­a

### File má»›i:
- `app/followers-list.tsx` - Trang danh sÃ¡ch followers/following
- `app/payment-pro.tsx` - Trang Pro features vÃ  thanh toÃ¡n
- `src/context/ThemeContext.tsx` - Quáº£n lÃ½ theme theo Pro status
- `IMPLEMENTATION_COMPLETE.md` - TÃ i liá»‡u chi tiáº¿t (tiáº¿ng Anh)

### File Ä‘Ã£ sá»­a:
- `app/(tabs)/account.tsx` - ThÃªm Pro badge, theme, followers/following
- `app/chat.tsx` - Sá»­a lá»—i tin nháº¯n láº·p
- `app/_layout.tsx` - ThÃªm routes má»›i vÃ  ThemeProvider
- `src/services/api.ts` - ThÃªm API methods cho Pro vÃ  followers
- `src/types/index.ts` - ThÃªm field isPro

## LÆ°u Ã Quan Trá»ng

1. **Test Mode**: Thanh toÃ¡n hiá»‡n Ä‘ang á»Ÿ cháº¿ Ä‘á»™ test, khÃ´ng thu tiá»n tháº­t
2. **KhÃ´ng tá»± gia háº¡n**: ÄÃºng nhÆ° yÃªu cáº§u, Ä‘Äƒng kÃ½ Pro khÃ´ng tá»± Ä‘á»™ng gia háº¡n hÃ ng thÃ¡ng
3. **Backend Integration**: Server cáº§n implement cÃ¡c API endpoints Ä‘Æ°á»£c liá»‡t kÃª á»Ÿ trÃªn
4. **Follow Limit**: Viá»‡c enforce giá»›i háº¡n 16/512 follows sáº½ Ä‘Æ°á»£c xá»­ lÃ½ á»Ÿ backend

## Káº¿ Hoáº¡ch TÆ°Æ¡ng Lai

Nhá»¯ng tÃ­nh nÄƒng cÃ³ thá»ƒ thÃªm sau:

1. **AI Post Writer**: TÃ­ch há»£p AI Ä‘á»ƒ giÃºp viáº¿t bÃ i post (cho Pro members)
2. **Theme cho toÃ n app**: Ãp dá»¥ng theme vÃ ng/xanh cho táº¥t cáº£ cÃ¡c mÃ n hÃ¬nh
3. **Pro indicators**: Hiá»ƒn thá»‹ badge Pro á»Ÿ nhiá»u nÆ¡i hÆ¡n
4. **Analytics**: Theo dÃµi sá»‘ lÆ°á»£ng ngÆ°á»i Ä‘Äƒng kÃ½ Pro
5. **Payment tháº­t**: TÃ­ch há»£p cá»•ng thanh toÃ¡n thá»±c (Stripe, PayPal, v.v.)

## Káº¿t Luáº­n

Táº¥t cáº£ cÃ¡c tÃ­nh nÄƒng báº¡n yÃªu cáº§u Ä‘Ã£ Ä‘Æ°á»£c hoÃ n thÃ nh:
- âœ… Inbox hiá»ƒn thá»‹ Ä‘Ãºng tÃªn vÃ  avatar cá»§a Ä‘á»‘i phÆ°Æ¡ng
- âœ… Tin nháº¯n khÃ´ng bá»‹ láº·p ná»¯a
- âœ… Xem Ä‘Æ°á»£c followers vÃ  following
- âœ… Há»‡ thá»‘ng Pro vá»›i test payment hoáº¡t Ä‘á»™ng
- âœ… Theme Ä‘á»•i mÃ u theo Pro status (xanh â†’ vÃ ng)
- âœ… Badge Pro hiá»ƒn thá»‹ trÃªn account
- âœ… Giá»›i háº¡n 16 vs 512 follows (backend sáº½ enforce)

App Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ test vÃ  tÃ­ch há»£p vá»›i backend!

Náº¿u cÃ³ báº¥t ká»³ cÃ¢u há»i nÃ o, hÃ£y cho tÃ´i biáº¿t nhÃ©! ğŸ˜Š
